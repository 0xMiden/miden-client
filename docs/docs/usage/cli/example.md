## Example: Executing, proving and submitting transactions

Once we have installed the CLI, we can use its features to interact with the Miden Node. Let's take a look at an example to familiarize ourselves. In this example, we'll mint assets with a fungible faucet for a basic account, which we will then transfer to a different account.

## Prerequisites

- Currently, the client allows for submitting locally-proven transactions to the Miden node. The simplest way to test the client is by [generating accounts via the genesis file](https://github.com/0xPolygonMiden/miden-node?tab=readme-ov-file#generating-the-genesis-file). 
  - For this example, we will make use of 1 faucet account and 2 regular wallet accounts, so you should set your node's `toml` config file accordingly. We will refer to these accounts as having IDs `regular account ID A` and `regular account ID B` in order differentiate them.
  - Once the account files have been generated, [make sure the node is running](https://github.com/0xPolygonMiden/miden-node?tab=readme-ov-file#running-the-node). If the node has some stored state from previous tests and usage, you might have to clear its database.
  - The client should be configured to use the running node's socket as its endpoint as explained in the previous section.

## Example

### 1. Loading account data

In order to execute transactions and change the account's states, you will first want to import the generated account information by running `miden-client account import`:

```bash
miden-client account import <path-to-accounts-directory>/*.mac
```

The client will then import all account-related data generated by the node (stored as `*.mac` files), and insert them in the local store. The accounts directory should be the one generated by the node when running the `make-genesis` command. You can now list the imported accounts by running:

```bash
miden-client account list
```
### 2. Synchronizing the state

As briefly mentioned in the [Overview](#overview) section, the client needs to periodically query the node to receive updates about entities that might be important in order to run transactions. The way to do so is by running the `sync` command:

```bash
miden-client sync
```

Running this command will update local data up to the chain tip. This is needed in order to execute and prove any transaction.

### 3. Minting an asset 

Since we have now synced our local view of the blockchain and have account information, we are ready to execute and submit tranasctions. For a first test, we are going to mint a fungible asset for a regular account.

```bash
miden-client tx new mint <regular-account-ID-A> <faucet-account-id> 1000
```

This will execute, prove and submit a transaction that mints assets to the node. The account that executes this transaction will be the faucet as was defined in the node's configuration file. In this case, it is minting `1000` fungible tokens to `<regular-account-ID-A>`. 

This will add a transaction and an output note (containing the minted asset) to the local store in order to track their lifecycles. You can display them by running `miden-client tx list` and `miden-client input-notes list` respectively. If you do so, you will notice that they do not show a `commit height` even though they were submitted to the operator. This is because our local view of the network has not yet been updated, so the client does not have a way to prove the inclusion of the note in the blockchain. After updating it with a `sync`, you should see the height at which the transaction and the note containing the asset were committed. This will allow us to prove transactions that make use of this note, as we can compute valid proofs that state that the note exists in the blockchain.

### 4. Consuming the note

After creating the note with the minted asset, the regular account can now consume it and add the tokens to its vault. You can do this the following way:

```bash
miden-client tx new consume-notes <regular-account-ID-A> <input-note-ID>
```

This will consume the input note identified by its ID, which you can get by listing them as explained in the previous step. Note that you can consume more than one note in a single transaction.

You will now be able to see the asset in the account's vault by running:

```bash
miden-client account show <regular-account-ID-A> -v
```

### 5. Transferring assets between accounts

Some of the tokens we minted can now be transferred to our second regular account. To do so, you can run:

```bash
miden-client sync # Make sure we have an updated view of the state
miden-client tx new p2id <regular-account-ID-A> <regular-account-ID-B> <faucet-account-ID> 50 # Transfers 50 tokens to account ID B
```

This will generate a Pay-to-ID (`P2ID`) note containing 50 assets, transferred from one regular account to the other. If we sync, we can now make use of the note and consume it for the receiving account:

```bash
miden-client sync # Make sure we have an updated view of the state
miden-client tx new consume-notes <regular-account-ID-B> # Consume the note
```

That's it! You will now be able to see `950` fungible tokens in the first regular account, and `50` tokens in the remaining regular account:

```bash
miden-client account show <regular-account-ID-B> -v # Show account B's vault assets (50 fungible tokens)
miden-client account show <regular-account-ID-A> -v # Show account A's vault assets (950 fungible tokens)
```
