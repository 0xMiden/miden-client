[package]
authors.workspace      = true
categories             = ["no-std"]
description            = "Client library that facilitates interaction with the Miden network"
documentation          = "https://docs.rs/miden-client/0.12.0"
edition.workspace      = true
keywords               = ["client", "miden"]
license.workspace      = true
name                   = "miden-client"
readme                 = "README.md"
repository.workspace   = true
rust-version.workspace = true
version.workspace      = true

[package.metadata.cargo-machete]
ignored = ["getrandom"]

[lib]
crate-type = ["lib"]

[features]
default   = ["std", "tonic/channel"]
std       = ["miden-objects/std", "miden-remote-prover-client/std", "miden-tx/concurrent"]
testing   = ["dep:miden-testing", "dep:uuid", "miden-lib/testing", "miden-objects/testing", "miden-tx/testing"]
tonic     = ["std", "tonic/tls-native-roots", "tonic/tls-ring", "tonic/transport"]
web-tonic = ["dep:getrandom", "dep:tonic-web-wasm-client"]

[dependencies]
# Miden dependencies
miden-lib                  = { workspace = true }
miden-objects              = { workspace = true }
miden-remote-prover-client = { default-features = false, features = ["tx-prover"], workspace = true }
miden-testing              = { optional = true, workspace = true }
miden-tx                   = { workspace = true }

# External dependencies
anyhow                = { workspace = true }
async-trait           = { workspace = true }
chrono                = { optional = false, version = "0.4" }
getrandom             = { features = ["wasm_js"], optional = true, version = "0.3" }
hex                   = { workspace = true }
prost                 = { default-features = false, features = ["derive"], version = "0.13" }
rand                  = { workspace = true }
thiserror             = { workspace = true }
tonic                 = { default-features = false, features = ["codegen", "prost"], version = "0.13" }
tonic-web-wasm-client = { default-features = false, optional = true, version = "0.7" }
tracing               = { workspace = true }
uuid                  = { features = ["js", "serde", "v4"], optional = true, version = "1.10" }

[target.'cfg(target_arch = "wasm32")'.dependencies]
web-sys = { features = ["Storage", "Window", "console"], version = "0.3" }

[build-dependencies]
miden-lib              = { workspace = true }
miden-node-proto-build = { workspace = true }
miden-objects          = { workspace = true }
miette                 = { workspace = true }
prost                  = { default-features = false, features = ["derive"], version = "0.13" }
prost-build            = { default-features = false, version = "0.13" }
protox                 = { version = "0.7" }
tonic-build            = { version = "0.13" }

[dev-dependencies]
miden-client              = { features = ["std", "testing"], path = "." }
miden-client-sqlite-store = { package = "miden-client-sqlite-store", path = "../sqlite-store", version = "0.12" }
miden-lib                 = { features = ["testing"], workspace = true }
miden-objects             = { default-features = false, features = ["testing"], workspace = true }
miden-testing             = { default-features = false, workspace = true }
tokio                     = { workspace = true }
web-sys                   = { features = ["console"], version = "0.3" }

[lints]
workspace = true
