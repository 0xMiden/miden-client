name = "multisig_auth"
description = "Multisig authentication component based on RPO Falcon512 signatures. Enforces a threshold of approver signatures for every transaction."
version = "0.1.0"
supported-types = ["RegularAccountUpdatableCode", "RegularAccountImmutableCode", "FungibleFaucet", "NonFungibleFaucet"]

[storage]
[[storage.slots]]
name = "miden::standards::auth::rpo_falcon512_multisig::threshold_config"
description = "Contains default threshold and number of approvers: [threshold, num_approvers, 0, 0]"
type = [
    { name = "threshold", type = "u32", description = "Default threshold of signatures required" },
    { name = "num_approvers", type = "u32", description = "Number of approvers" },
    { type = "void" },
    { type = "void" },
]

[[storage.slots]]
name = "miden::standards::auth::rpo_falcon512_multisig::approver_public_keys"
description = "Map with approver public keys (index -> pubkey)"
type = { key = "word", value = "miden::standards::auth::falcon512_rpo::pub_key" }

[[storage.slots]]
name = "miden::standards::auth::rpo_falcon512_multisig::executed_transactions"
description = "Map which stores executed transactions"
type = { key = "word", value = "word" }

[[storage.slots]]
name = "miden::standards::auth::rpo_falcon512_multisig::procedure_thresholds"
description = "Map which stores procedure thresholds (PROC_ROOT -> threshold)"
type = { key = "word", value = "u32" }
